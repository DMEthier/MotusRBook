<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R for Motus</title>
  <meta name="description" content="R for Motus">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="R for Motus" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="BSC_Motus_Logo.png" />
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R for Motus" />
  
  
  <meta name="twitter:image" content="BSC_Motus_Logo.png" />

<meta name="author" content="Tara L. Crewe and Zoe Crysler">


<meta name="date" content="2017-10-18">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="loading-the-motus-r-package.html">
<link rel="next" href="data-checking-metadata.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R for Motus</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>A walk through the use of R for Motus automated radio-telemetry data</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-this-book-does-not-cover"><i class="fa fa-check"></i><b>1.1</b> What this book does not cover</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#prerequisites"><i class="fa fa-check"></i><b>1.2</b> Prerequisites</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#how-this-book-is-organized"><i class="fa fa-check"></i><b>1.3</b> How this book is organized</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#sample-dataset"><i class="fa fa-check"></i><b>1.4</b> Sample dataset</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#acknowledgements"><i class="fa fa-check"></i><b>1.5</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="loading-the-motus-r-package.html"><a href="loading-the-motus-r-package.html"><i class="fa fa-check"></i><b>2</b> Loading the Motus R Package</a><ul>
<li class="chapter" data-level="2.1" data-path="loading-the-motus-r-package.html"><a href="loading-the-motus-r-package.html#user-authentication"><i class="fa fa-check"></i><b>2.1</b> User Authentication</a></li>
<li class="chapter" data-level="2.2" data-path="loading-the-motus-r-package.html"><a href="loading-the-motus-r-package.html#internal-data-processing"><i class="fa fa-check"></i><b>2.2</b> Internal data processing</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="accessing-and-understanding-detections-data.html"><a href="accessing-and-understanding-detections-data.html"><i class="fa fa-check"></i><b>3</b> Accessing and understanding detections data</a><ul>
<li class="chapter" data-level="3.1" data-path="accessing-and-understanding-detections-data.html"><a href="accessing-and-understanding-detections-data.html#database-types"><i class="fa fa-check"></i><b>3.1</b> Database types</a></li>
<li class="chapter" data-level="3.2" data-path="accessing-and-understanding-detections-data.html"><a href="accessing-and-understanding-detections-data.html#load-relevant-r-packages"><i class="fa fa-check"></i><b>3.2</b> Load relevant R packages</a></li>
<li class="chapter" data-level="3.3" data-path="accessing-and-understanding-detections-data.html"><a href="accessing-and-understanding-detections-data.html#importing-tag-detections"><i class="fa fa-check"></i><b>3.3</b> Importing tag detections</a></li>
<li class="chapter" data-level="3.4" data-path="accessing-and-understanding-detections-data.html"><a href="accessing-and-understanding-detections-data.html#data-structure"><i class="fa fa-check"></i><b>3.4</b> Data structure</a><ul>
<li class="chapter" data-level="3.4.1" data-path="accessing-and-understanding-detections-data.html"><a href="accessing-and-understanding-detections-data.html#convert-a-virtual-table-to-a-flat-dataframe"><i class="fa fa-check"></i><b>3.4.1</b> Convert a virtual table to a flat dataframe</a></li>
<li class="chapter" data-level="3.4.2" data-path="accessing-and-understanding-detections-data.html"><a href="accessing-and-understanding-detections-data.html#export-your-flat-dataframe-to-a-.csv-file"><i class="fa fa-check"></i><b>3.4.2</b> Export your “flat” dataframe to a .csv file</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-checking-metadata.html"><a href="data-checking-metadata.html"><i class="fa fa-check"></i><b>4</b> Data Checking: Metadata</a><ul>
<li class="chapter" data-level="4.1" data-path="data-checking-metadata.html"><a href="data-checking-metadata.html#load-relevant-r-packages-1"><i class="fa fa-check"></i><b>4.1</b> Load relevant R packages</a></li>
<li class="chapter" data-level="4.2" data-path="data-checking-metadata.html"><a href="data-checking-metadata.html#tag-metadata"><i class="fa fa-check"></i><b>4.2</b> Tag Metadata</a><ul>
<li class="chapter" data-level="4.2.1" data-path="data-checking-metadata.html"><a href="data-checking-metadata.html#import-data"><i class="fa fa-check"></i><b>4.2.1</b> Import Data</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-checking-metadata.html"><a href="data-checking-metadata.html#tag-metadata-checks"><i class="fa fa-check"></i><b>4.2.2</b> Tag Metadata Checks</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-checking-metadata.html"><a href="data-checking-metadata.html#receiver-metadata"><i class="fa fa-check"></i><b>4.2.3</b> Receiver Metadata</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-checking-metadata.html"><a href="data-checking-metadata.html#searching-for-false-positives"><i class="fa fa-check"></i><b>4.3</b> Searching for false positives</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cleaning-data-to-remove-false-detections.html"><a href="cleaning-data-to-remove-false-detections.html"><i class="fa fa-check"></i><b>5</b> Cleaning data to remove false detections</a><ul>
<li class="chapter" data-level="5.1" data-path="cleaning-data-to-remove-false-detections.html"><a href="cleaning-data-to-remove-false-detections.html#load-relevant-r-packages-2"><i class="fa fa-check"></i><b>5.1</b> Load relevant R packages</a></li>
<li class="chapter" data-level="5.2" data-path="cleaning-data-to-remove-false-detections.html"><a href="cleaning-data-to-remove-false-detections.html#removing-detections-outside-of-deployment-range"><i class="fa fa-check"></i><b>5.2</b> Removing detections outside of deployment range</a></li>
<li class="chapter" data-level="5.3" data-path="cleaning-data-to-remove-false-detections.html"><a href="cleaning-data-to-remove-false-detections.html#removing-detections-based-on-visual-geographic-positions"><i class="fa fa-check"></i><b>5.3</b> Removing detections based on visual geographic positions</a></li>
<li class="chapter" data-level="5.4" data-path="cleaning-data-to-remove-false-detections.html"><a href="cleaning-data-to-remove-false-detections.html#removing-detections-based-on-estimated-flight-speed"><i class="fa fa-check"></i><b>5.4</b> Removing detections based on estimated flight speed</a></li>
<li class="chapter" data-level="5.5" data-path="cleaning-data-to-remove-false-detections.html"><a href="cleaning-data-to-remove-false-detections.html#removing-false-positives-based-on-hitids"><i class="fa fa-check"></i><b>5.5</b> Removing false positives based on hitID’s</a></li>
<li class="chapter" data-level="5.6" data-path="cleaning-data-to-remove-false-detections.html"><a href="cleaning-data-to-remove-false-detections.html#removing-detections-based-on-automated-filtering"><i class="fa fa-check"></i><b>5.6</b> Removing detections based on automated filtering</a></li>
<li class="chapter" data-level="5.7" data-path="cleaning-data-to-remove-false-detections.html"><a href="cleaning-data-to-remove-false-detections.html#duplicate-tags-and-ambiguous-detections"><i class="fa fa-check"></i><b>5.7</b> Duplicate tags and ambiguous detections</a><ul>
<li class="chapter" data-level="5.7.1" data-path="cleaning-data-to-remove-false-detections.html"><a href="cleaning-data-to-remove-false-detections.html#check-for-ambiguous-tags"><i class="fa fa-check"></i><b>5.7.1</b> Check for ambiguous tags</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="exploring-data-with-the-motus-r-package.html"><a href="exploring-data-with-the-motus-r-package.html"><i class="fa fa-check"></i><b>6</b> Exploring data with the Motus R package</a><ul>
<li class="chapter" data-level="6.1" data-path="exploring-data-with-the-motus-r-package.html"><a href="exploring-data-with-the-motus-r-package.html#summarizing-your-data"><i class="fa fa-check"></i><b>6.1</b> Summarizing your data</a></li>
<li class="chapter" data-level="6.2" data-path="exploring-data-with-the-motus-r-package.html"><a href="exploring-data-with-the-motus-r-package.html#plotting-your-data"><i class="fa fa-check"></i><b>6.2</b> Plotting your data</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Motus</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="accessing-and-understanding-detections-data" class="section level1">
<h1><span class="header-section-number">3</span> Accessing and understanding detections data</h1>
<p>It is important to note that the success of the Motus network is dependent on the timely upload of detection data from receivers, and on the maintenance of accurate and up to date tag and receiver metadata by collaborators. Users are encouraged to check for updated detection data and metadata each time they run an analysis, because collaborators can add detection data and metadata at any time, and these could influence the completeness of your own detections data.</p>
<div id="database-types" class="section level2">
<h2><span class="header-section-number">3.1</span> Database types</h2>
<p><img src="images/DataStructure.PNG" width="804" /></p>
<p><br></p>
<p>There are two types of tag databases:</p>
<ol style="list-style-type: decimal">
<li><p><strong>receiver database</strong>: includes all detections of any registered tags from a single receiver. A receiver database has a name like SG-1234BBBK5678.motus; where the name is the serial number of the receiver.</p></li>
<li><p><strong>project database</strong>: includes all detections of your registered tags from across the motus network. A tag project database has a name like project-123.motus, where the number is the motus project ID.</p></li>
</ol>
<p>These two databases correspond to the basic model of data sharing:</p>
<ol style="list-style-type: decimal">
<li><p>you get all detections of anyone’s tags by <em>your</em> receivers (i.e., one receiver tag database for each receiver you deploy)</p></li>
<li><p>you get all detections of <em>your</em> tags by <em>anyone’s</em> receivers (i.e., one project tag database for each of your motus projects)</p></li>
</ol>
</div>
<div id="load-relevant-r-packages" class="section level2">
<h2><span class="header-section-number">3.2</span> Load relevant R packages</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(devtools)
<span class="kw">require</span>(tidyverse)</code></pre></div>
</div>
<div id="importing-tag-detections" class="section level2">
<h2><span class="header-section-number">3.3</span> Importing tag detections</h2>
<p>Your project’s .motus file is available for download at <a href="https://motus.org/data/downloads" class="uri">https://motus.org/data/downloads</a> under your project profile. Once downloaded, <strong>make sure that you have the appropriate packages installed and loaded in R as outlined in Chapter 2-LoadingPackage</strong>. Once packages are loaded, you can import your tag detections into R using the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">file.name &lt;-<span class="st"> &quot;./data/project-8.motus&quot;</span>    ## replace with the full location of your project data
t &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">src_sqlite</span>(file.name)</code></pre></div>
</div>
<div id="data-structure" class="section level2">
<h2><span class="header-section-number">3.4</span> Data structure</h2>
<p>Your tag database is stored as an SQLite (‘dplyr::src_sqlite’) file with the extension ‘.motus’. The sqlite format was chosen because:</p>
<ol style="list-style-type: decimal">
<li>it is flexible, allowing for many data formats.</li>
<li>it is accessible from many software platforms (not just R).</li>
<li>it is <strong>appendable</strong>: the database can be created and updated on disk without having to read in and resave the entire contents. This will save time and computer memory when searching to see if any new detections are available for your project or receiver.</li>
</ol>
<p>The .motus file contains a series of interelated tables where data are stored in a condensed format to save memory. The following tables are included in the .motus file; a complete list of parameters stored in each table can be found in Appendix Table A1:</p>
<ol style="list-style-type: decimal">
<li>hits: detections data at the level of individual hits.</li>
<li>runs: detections data associated with a run (continuous detections of a unique tag on a given receiver).</li>
<li>batches: detections data for a given receiver and boot number.</li>
<li>tags: metadata related to tags, e.g., unique identifier, tag characteristics (e.g., burst interval).</li>
<li>tagDeps: metadata related to tag deployments, e.g., deployment date, location, and species.</li>
<li>recvDeps: metadata related to receiver deployments, e.g., deployment date, location, receiver characteristics.</li>
<li>antDeps: metadata related to antenna deployments, e.g., deployment height, angle, antenna type.</li>
<li>species: metadata related to species, e.g., unique identifier, scientific name, common name.</li>
<li>projs: metadata related to projects, e.g., project name, principal investigator.</li>
<li>gps: metadata related to Geographic Positioning System (GPS) position of receiver.</li>
</ol>
<p>Because the file is a dplyr::src_sqlite file, all of the dplyr functions can be used to filter and summarize your .motus database, without needing to first save the data as a <em>flat</em> file, i.e., a typical two-dimensional dataframe with every record for each field filled in.</p>
<p>You can access each table in the .motus file using the tbl() function, for example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># tag deployment metadata</span>
tagMeta &lt;-<span class="st"> </span><span class="kw">tbl</span>(t, <span class="st">&quot;tagDeps&quot;</span>)
<span class="kw">head</span>(tagMeta)           </code></pre></div>
<pre><code>## # Source:   lazy query [?? x 19]
## # Database: sqlite 3.19.3 [/Users/zoecrysler/Documents/BSC
## #   2016/Motus/MotusRBook/data/project-8.motus]
##   deployID tagID projectID status    tsStart      tsEnd deferSec speciesID
##      &lt;int&gt; &lt;int&gt;     &lt;int&gt;  &lt;chr&gt;      &lt;dbl&gt;      &lt;dbl&gt;    &lt;int&gt;     &lt;int&gt;
## 1     1243 17382         8   &lt;NA&gt; 1376982000 1381815586        0      4690
## 2     1244 17383         8   &lt;NA&gt; 1376982000 1381815808        0      4690
## 3     1245 17384         8   &lt;NA&gt; 1376982000 1381815863        0      4690
## 4     1247 17386         8   &lt;NA&gt; 1376982000 1381870923        0      4690
## 5     1248 17387         8   &lt;NA&gt; 1376982000 1381870923        0      4690
## 6     1250 17389         8   &lt;NA&gt; 1376982000 1381924030        0      4690
## # ... with 11 more variables: markerNumber &lt;chr&gt;, markerType &lt;chr&gt;,
## #   latitude &lt;dbl&gt;, longitude &lt;dbl&gt;, elevation &lt;dbl&gt;, comments &lt;chr&gt;,
## #   id &lt;int&gt;, bi &lt;dbl&gt;, tsStartCode &lt;int&gt;, tsEndCode &lt;int&gt;, fullID &lt;chr&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tagMeta<span class="op">$</span>ops<span class="op">$</span>vars        </code></pre></div>
<pre><code>##  [1] &quot;deployID&quot;     &quot;tagID&quot;        &quot;projectID&quot;    &quot;status&quot;      
##  [5] &quot;tsStart&quot;      &quot;tsEnd&quot;        &quot;deferSec&quot;     &quot;speciesID&quot;   
##  [9] &quot;markerNumber&quot; &quot;markerType&quot;   &quot;latitude&quot;     &quot;longitude&quot;   
## [13] &quot;elevation&quot;    &quot;comments&quot;     &quot;id&quot;           &quot;bi&quot;          
## [17] &quot;tsStartCode&quot;  &quot;tsEndCode&quot;    &quot;fullID&quot;</code></pre>
<p>If you look at the underlying structure of these tables using str(), you will see that each is a list of length 2:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(tagMeta)</code></pre></div>
<pre><code>## List of 2
##  $ src:List of 2
##   ..$ con  :Formal class &#39;SQLiteConnection&#39; [package &quot;RSQLite&quot;] with 6 slots
##   .. .. ..@ ptr                :&lt;externalptr&gt; 
##   .. .. ..@ dbname             : chr &quot;/Users/zoecrysler/Documents/BSC 2016/Motus/MotusRBook/data/project-8.motus&quot;
##   .. .. ..@ loadable.extensions: logi TRUE
##   .. .. ..@ flags              : int 70
##   .. .. ..@ vfs                : chr &quot;&quot;
##   .. .. ..@ ref                :&lt;environment: 0x7fe5de83f208&gt; 
##   ..$ disco:&lt;environment: 0x7fe5deb9db18&gt; 
##   ..- attr(*, &quot;class&quot;)= chr [1:3] &quot;src_dbi&quot; &quot;src_sql&quot; &quot;src&quot;
##  $ ops:List of 2
##   ..$ x   :Classes &#39;ident&#39;, &#39;character&#39;  chr &quot;tagDeps&quot;
##   ..$ vars: chr [1:19] &quot;deployID&quot; &quot;tagID&quot; &quot;projectID&quot; &quot;status&quot; ...
##   ..- attr(*, &quot;class&quot;)= chr [1:3] &quot;op_base_remote&quot; &quot;op_base&quot; &quot;op&quot;
##  - attr(*, &quot;class&quot;)= chr [1:4] &quot;tbl_dbi&quot; &quot;tbl_sql&quot; &quot;tbl_lazy&quot; &quot;tbl&quot;</code></pre>
<p>The first part of the list, ‘src’, is a list that provides details of the SQLiteConnection, which includes information on where the database is stored. The second part of the list, ‘ops’, is also a list, and includes the names of the variables (‘tagMeta<span class="math inline">\(ops\)</span>vars’) included in the table. In other words, in its current form, the R object ‘tagMeta’ does not hold the data itself (i.e., it is a <em>virtual</em> table); rather, it includes the database structure and information required to connect to the underlying data in the .motus file. As stated above, the advantage of storing the data in this way is that it saves memory when accessing very large databases, and the dplyr package can be used to manipulate and summarize the tables before collecting the results into a typical “flat” format dataframe.</p>
<p>For your convienience, the <em>virtual</em> table ‘alltags’ contains all fields that most users will need from the various .motus tables, and can also be accessed using the dplyr tbl() function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">tbl</span>(t, <span class="st">&quot;alltags&quot;</span>)</code></pre></div>
<p>The following table lists the parameters available in the ‘alltags’ table, along with a description of each parameter.</p>
<table>
<caption><span id="tab:parameterTable">Table 3.1: </span>Description of fields in the tag detections database</caption>
<thead>
<tr class="header">
<th align="left">Field</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">hitID</td>
<td align="left">unique Motus ID for this tag detection</td>
</tr>
<tr class="even">
<td align="left">runID</td>
<td align="left">unique Motus ID for the run this detection belongs to</td>
</tr>
<tr class="odd">
<td align="left">batchID</td>
<td align="left">unique Motus ID for the processing batch this detection came from</td>
</tr>
<tr class="even">
<td align="left">ts</td>
<td align="left">timestamp, in seconds since 1 Jan, 1970 GMT; precision: 0.1 ms (SG); 2.5 ms (Lotek).</td>
</tr>
<tr class="odd">
<td align="left">sig</td>
<td align="left">signal strength in “native units”; for SG: dB (max) (logarithmic, 0 = max possible, -10 = 0.1 * max, etc.); for Lotek: raw value (0…255)</td>
</tr>
<tr class="even">
<td align="left">sigSD</td>
<td align="left">std. dev. in signal strength among pulses in this burst. SG Only; NA for Lotek</td>
</tr>
<tr class="odd">
<td align="left">noise</td>
<td align="left">estimate of background radio noise when tag detected, in dB (max) for SG; NA for Lotek</td>
</tr>
<tr class="even">
<td align="left">freq</td>
<td align="left">frequency offset from antenna listening frequency, in kHz for SG only; NA for Lote</td>
</tr>
<tr class="odd">
<td align="left">freqSD</td>
<td align="left">std. dev. of freq offset among pulses in this burst, in kHz. Values larger than 0.1 kHz suggest a bogus detection. SG only; NA for Lotek.</td>
</tr>
<tr class="even">
<td align="left">slop</td>
<td align="left">total absolute difference (milliseconds) in inter-pulse intervals for this burst between registration and detection. SG only; NA for Lotek</td>
</tr>
<tr class="odd">
<td align="left">burstSlop</td>
<td align="left">signed difference (seconds) between detection and registration burst intervals. This is always 0 for the first burst in a run (see posInRun)</td>
</tr>
<tr class="even">
<td align="left">done</td>
<td align="left">logical: is run finished?</td>
</tr>
<tr class="odd">
<td align="left">motusTagID</td>
<td align="left">Motus tag ID - unique to each individual tag registered</td>
</tr>
<tr class="even">
<td align="left">ant</td>
<td align="left">antenna code (for sensorgnomes, USB port number; for Lotek, whatever they use, usually numeric, but can be e.g. AH0)</td>
</tr>
<tr class="odd">
<td align="left">runLen</td>
<td align="left">number of tag bursts in the current run; constant for all records having the same runID</td>
</tr>
<tr class="even">
<td align="left">bootnum</td>
<td align="left">boot session of receiver for SG; NA for Lotek</td>
</tr>
<tr class="odd">
<td align="left">tagProjectID</td>
<td align="left">ID of the project that manages this tag.</td>
</tr>
<tr class="even">
<td align="left">id</td>
<td align="left">manufacturer ID</td>
</tr>
<tr class="odd">
<td align="left">tagType</td>
<td align="left">all rows are “ID”??</td>
</tr>
<tr class="even">
<td align="left">codeSet</td>
<td align="left">for coded tags, the name of the codeset (e.g. ‘Lotek-3’)</td>
</tr>
<tr class="odd">
<td align="left">mfg</td>
<td align="left">tag manufacturer</td>
</tr>
<tr class="even">
<td align="left">tagModel</td>
<td align="left">manufacturer’s model name for a tag (e.g. ‘NTQB-3-2’)</td>
</tr>
<tr class="odd">
<td align="left">tagLifespan</td>
<td align="left">estimated lifespan of tag (days)</td>
</tr>
<tr class="even">
<td align="left">nomFreq</td>
<td align="left">nominal tag frequency (MOTUS: Nominal frequency receiver was tuned to, in Mhz. This really only applies to SG, where we usually tune 4 kHz below the nominal tag frequency. So in that case, antFreq = 166.376 while nomFreq = 166.380</td>
</tr>
<tr class="odd">
<td align="left">tagBI</td>
<td align="left">burst interval of tag, in seconds (e.g., 5.8984)</td>
</tr>
<tr class="even">
<td align="left">pulseLen</td>
<td align="left">tag pulse length (milliseconds), if applicable. This value is only assigned based on the sample recording of the tag.</td>
</tr>
<tr class="odd">
<td align="left">speciesID</td>
<td align="left">unique numeric Motus ID (integer) for the species on which the tag was deployed</td>
</tr>
<tr class="even">
<td align="left">markerNumber</td>
<td align="left">number for any additional marker placed on organism (e.g., bird band #)</td>
</tr>
<tr class="odd">
<td align="left">markerType</td>
<td align="left">type of additional marker (e.g. metal band)</td>
</tr>
<tr class="even">
<td align="left">depLat</td>
<td align="left">latitude of tag deployment, in decimal degrees N - negative values for Southern hemisphere</td>
</tr>
<tr class="odd">
<td align="left">depLon</td>
<td align="left">longitude of tag deployment, in decimal degrees E - negative values for Western hemisphere</td>
</tr>
<tr class="even">
<td align="left">depAlt</td>
<td align="left">altitude of tag deployment, in meters ASL</td>
</tr>
<tr class="odd">
<td align="left">comments</td>
<td align="left">additional comments or unclassified metadata for tag (often in JSON format)</td>
</tr>
<tr class="even">
<td align="left">startCode</td>
<td align="left">integer code giving method for determining tag deployment start timestamp</td>
</tr>
<tr class="odd">
<td align="left">endCode</td>
<td align="left">integer code giving method for determining tag deployment end timestamp</td>
</tr>
<tr class="even">
<td align="left">fullID</td>
<td align="left">full tag ID as PROJECT#MFGID:<a href="mailto:BI@NOMFREQ">BI@NOMFREQ</a>. Not necessarily unique over time. See motusTagID for a unique tag</td>
</tr>
<tr class="odd">
<td align="left">recv</td>
<td align="left">serial number of the receiver; e.g., SG-1234BBBK5678 or Lotek-12345</td>
</tr>
<tr class="even">
<td align="left">site</td>
<td align="left">name assigned to a site by the project manager (e.g. location name). This field is optional, and the same label can be used for multiple deployments.</td>
</tr>
<tr class="odd">
<td align="left">isMobile</td>
<td align="left">logical; whether the sensor is deployed on a mobile platform (eg. a ship)</td>
</tr>
<tr class="even">
<td align="left">projID</td>
<td align="left">unique (numeric) ID of the project that deployed this receiver (e.g., 8)</td>
</tr>
<tr class="odd">
<td align="left">antType</td>
<td align="left">character; antenna type, e.g. “9-element Yagi”, “Omni”</td>
</tr>
<tr class="even">
<td align="left">antBearing</td>
<td align="left">numeric; compass direction antenna main axis is pointing at (degrees clockwise from local magnetic North 0-360)</td>
</tr>
<tr class="odd">
<td align="left">antHeight</td>
<td align="left">numeric; height (meters) of antenna main axis above ground</td>
</tr>
<tr class="even">
<td align="left">cableLen</td>
<td align="left">numeric; length of coax cable (meters) connecting antenna to funcubedongle radio (optional)</td>
</tr>
<tr class="odd">
<td align="left">cableType</td>
<td align="left">type of coax cable connecting antenna to funcubedongle radio (optional)</td>
</tr>
<tr class="even">
<td align="left">mountDistance</td>
<td align="left">numeric; distance (meters) between antenna mounting (axis centre) and receiver GPS; SG only</td>
</tr>
<tr class="odd">
<td align="left">mountBearing</td>
<td align="left">numeric; bearing of base of antenna mounting from receiver GPS (degrees clockwise from magnetic north: 0-360); SG only</td>
</tr>
<tr class="even">
<td align="left">polarization1</td>
<td align="left">numeric; antenna polarization angle: azimuth component (degrees clockwise from local magnetic north)</td>
</tr>
<tr class="odd">
<td align="left">polarization2</td>
<td align="left">numeric; antenna polarization angle: elevation component (degrees above horizon)</td>
</tr>
<tr class="even">
<td align="left">spEN</td>
<td align="left">species English (common) name</td>
</tr>
<tr class="odd">
<td align="left">spFR</td>
<td align="left">species French (common) name</td>
</tr>
<tr class="even">
<td align="left">spSci</td>
<td align="left">species scientific name</td>
</tr>
<tr class="odd">
<td align="left">spGroup</td>
<td align="left">species group, e.g., BIRDS, BATS</td>
</tr>
<tr class="even">
<td align="left">tagProj</td>
<td align="left">short label of project that deployed the tag, e.g., “HolbSESA”</td>
</tr>
<tr class="odd">
<td align="left">projID</td>
<td align="left">short label of project that deployed the receiver</td>
</tr>
<tr class="even">
<td align="left">lat</td>
<td align="left">latitude of receiver GPS location at time of writing the hourly detections file (degrees North)</td>
</tr>
<tr class="odd">
<td align="left">lon</td>
<td align="left">longitude of receiver GPS location at time of writing the hourly detections file (degrees East)</td>
</tr>
<tr class="even">
<td align="left">alt</td>
<td align="left">altitude of receiver GPS at time of writing the hourly detections file (meters)</td>
</tr>
</tbody>
</table>
<div id="convert-a-virtual-table-to-a-flat-dataframe" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Convert a virtual table to a flat dataframe</h3>
<p>If you want your entire dataframe in a typical “flat” format, i.e., with every record for each field filled in, you can use the collect() function. The output can then be used to generate a .rds or .csv file of your data. However, we caution that producing such a table using the full suite of fields can chew up a lot of memory, and can slow R down considerably when dealing with large datasets:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.flat &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>collect <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame      ## for all fields in the df</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(df.flat)     ## field names</code></pre></div>
<pre><code>##  [1] &quot;hitID&quot;         &quot;runID&quot;         &quot;batchID&quot;       &quot;ts&quot;           
##  [5] &quot;sig&quot;           &quot;sigsd&quot;         &quot;noise&quot;         &quot;freq&quot;         
##  [9] &quot;freqsd&quot;        &quot;slop&quot;          &quot;burstSlop&quot;     &quot;done&quot;         
## [13] &quot;motusTagID&quot;    &quot;ant&quot;           &quot;runLen&quot;        &quot;bootnum&quot;      
## [17] &quot;tagProjID&quot;     &quot;id&quot;            &quot;tagType&quot;       &quot;codeSet&quot;      
## [21] &quot;mfg&quot;           &quot;tagModel&quot;      &quot;tagLifespan&quot;   &quot;nomFreq&quot;      
## [25] &quot;tagBI&quot;         &quot;pulseLen&quot;      &quot;speciesID&quot;     &quot;markerNumber&quot; 
## [29] &quot;markerType&quot;    &quot;depLat&quot;        &quot;depLon&quot;        &quot;depAlt&quot;       
## [33] &quot;comments&quot;      &quot;startCode&quot;     &quot;endCode&quot;       &quot;fullID&quot;       
## [37] &quot;recv&quot;          &quot;site&quot;          &quot;isMobile&quot;      &quot;projID&quot;       
## [41] &quot;antType&quot;       &quot;antBearing&quot;    &quot;antHeight&quot;     &quot;cableLen&quot;     
## [45] &quot;cableType&quot;     &quot;mountDistance&quot; &quot;mountBearing&quot;  &quot;polarization1&quot;
## [49] &quot;polarization2&quot; &quot;spEN&quot;          &quot;spFR&quot;          &quot;spSci&quot;        
## [53] &quot;spGroup&quot;       &quot;tagProj&quot;       &quot;proj&quot;          &quot;lat&quot;          
## [57] &quot;lon&quot;           &quot;alt&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(df.flat)       ## Look at the structure of your data fields</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    149939 obs. of  58 variables:
##  $ hitID        : int  13188267 13188268 13278887 13278888 13394729 13394730 13394754 13394755 13395278 13395279 ...
##  $ runID        : int  1145488 1145488 1188221 1188221 1200490 1200490 1200497 1200497 1200553 1200553 ...
##  $ batchID      : int  58 58 1224 1224 64 64 64 64 64 64 ...
##  $ ts           : num  1.41e+09 1.41e+09 1.41e+09 1.41e+09 1.41e+09 ...
##  $ sig          : num  175 132 175 132 255 218 252 251 252 251 ...
##  $ sigsd        : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ noise        : num  -96 -96 -96 -96 -96 -96 -96 -96 -96 -96 ...
##  $ freq         : num  4 4 4 4 4 4 4 4 4 4 ...
##  $ freqsd       : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ slop         : num  1e-04 1e-04 1e-04 1e-04 2e-04 2e-04 2e-04 2e-04 2e-04 2e-04 ...
##  $ burstSlop    : num  0 -0.002 0 -0.002 0 0.0066 0 -0.0056 0 -0.0056 ...
##  $ done         : int  1 1 0 0 1 1 1 1 1 1 ...
##  $ motusTagID   : int  10471 10471 10471 10471 10506 10506 10506 10506 10506 10506 ...
##  $ ant          : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ runLen       : int  2 2 2 2 2 2 2 2 2 2 ...
##  $ bootnum      : int  1 1 132 132 1 1 1 1 1 1 ...
##  $ tagProjID    : int  8 8 8 8 8 8 8 8 8 8 ...
##  $ id           : chr  &quot;28&quot; &quot;28&quot; &quot;28&quot; &quot;28&quot; ...
##  $ tagType      : chr  &quot;ID&quot; &quot;ID&quot; &quot;ID&quot; &quot;ID&quot; ...
##  $ codeSet      : chr  &quot;Lotek4&quot; &quot;Lotek4&quot; &quot;Lotek4&quot; &quot;Lotek4&quot; ...
##  $ mfg          : chr  &quot;Lotek&quot; &quot;Lotek&quot; &quot;Lotek&quot; &quot;Lotek&quot; ...
##  $ tagModel     : chr  &quot;NTQB-2&quot; &quot;NTQB-2&quot; &quot;NTQB-2&quot; &quot;NTQB-2&quot; ...
##  $ tagLifespan  : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ nomFreq      : num  166 166 166 166 166 ...
##  $ tagBI        : num  5.9 5.9 5.9 5.9 6.1 ...
##  $ pulseLen     : num  2.5 2.5 2.5 2.5 2.5 2.5 2.5 2.5 2.5 2.5 ...
##  $ speciesID    : int  4690 4690 4690 4690 4690 4690 4690 4690 4690 4690 ...
##  $ markerNumber : chr  &quot;257156244&quot; &quot;257156244&quot; &quot;257156244&quot; &quot;257156244&quot; ...
##  $ markerType   : chr  &quot;metal band&quot; &quot;metal band&quot; &quot;metal band&quot; &quot;metal band&quot; ...
##  $ depLat       : num  44.6 44.6 44.6 44.6 44.6 ...
##  $ depLon       : num  -67.8 -67.8 -67.8 -67.8 -67.8 ...
##  $ depAlt       : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ comments     : chr  NA NA NA NA ...
##  $ startCode    : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ endCode      : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ fullID       : chr  &quot;?proj?-8#28:5.9&quot; &quot;?proj?-8#28:5.9&quot; &quot;?proj?-8#28:5.9&quot; &quot;?proj?-8#28:5.9&quot; ...
##  $ recv         : chr  NA NA NA NA ...
##  $ site         : chr  NA NA NA NA ...
##  $ isMobile     : int  NA NA NA NA 0 0 0 0 0 0 ...
##  $ projID       : int  NA NA NA NA 10 10 10 10 10 10 ...
##  $ antType      : chr  NA NA NA NA ...
##  $ antBearing   : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ antHeight    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ cableLen     : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ cableType    : chr  NA NA NA NA ...
##  $ mountDistance: num  NA NA NA NA NA NA NA NA NA NA ...
##  $ mountBearing : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ polarization1: num  NA NA NA NA NA NA NA NA NA NA ...
##  $ polarization2: num  NA NA NA NA NA NA NA NA NA NA ...
##  $ spEN         : chr  &quot;Semipalmated Sandpiper&quot; &quot;Semipalmated Sandpiper&quot; &quot;Semipalmated Sandpiper&quot; &quot;Semipalmated Sandpiper&quot; ...
##  $ spFR         : chr  &quot;Bécasseau semipalmé&quot; &quot;Bécasseau semipalmé&quot; &quot;Bécasseau semipalmé&quot; &quot;Bécasseau semipalmé&quot; ...
##  $ spSci        : chr  &quot;Calidris pusilla&quot; &quot;Calidris pusilla&quot; &quot;Calidris pusilla&quot; &quot;Calidris pusilla&quot; ...
##  $ spGroup      : chr  &quot;BIRDS&quot; &quot;BIRDS&quot; &quot;BIRDS&quot; &quot;BIRDS&quot; ...
##  $ tagProj      : chr  &quot;HolbSESA&quot; &quot;HolbSESA&quot; &quot;HolbSESA&quot; &quot;HolbSESA&quot; ...
##  $ proj         : chr  NA NA NA NA ...
##  $ lat          : num  0 0 0 0 0 ...
##  $ lon          : num  0 0 0 0 0 ...
##  $ alt          : num  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(df.flat)      ## Look at first 6 rows of your df</code></pre></div>
<pre><code>##      hitID   runID batchID         ts sig sigsd noise freq freqsd  slop
## 1 13188267 1145488      58 1411570640 175     0   -96    4      0 1e-04
## 2 13188268 1145488      58 1411570688 132     0   -96    4      0 1e-04
## 3 13278887 1188221    1224 1411570640 175     0   -96    4      0 1e-04
## 4 13278888 1188221    1224 1411570688 132     0   -96    4      0 1e-04
## 5 13394729 1200490      64 1411741849 255     0   -96    4      0 2e-04
## 6 13394730 1200490      64 1411741928 218     0   -96    4      0 2e-04
##   burstSlop done motusTagID ant runLen bootnum tagProjID  id tagType
## 1    0.0000    1      10471   0      2       1         8  28      ID
## 2   -0.0020    1      10471   0      2       1         8  28      ID
## 3    0.0000    0      10471   0      2     132         8  28      ID
## 4   -0.0020    0      10471   0      2     132         8  28      ID
## 5    0.0000    1      10506   0      2       1         8 416      ID
## 6    0.0066    1      10506   0      2       1         8 416      ID
##   codeSet   mfg tagModel tagLifespan nomFreq  tagBI pulseLen speciesID
## 1  Lotek4 Lotek   NTQB-2          NA  166.38 5.8985      2.5      4690
## 2  Lotek4 Lotek   NTQB-2          NA  166.38 5.8985      2.5      4690
## 3  Lotek4 Lotek   NTQB-2          NA  166.38 5.8985      2.5      4690
## 4  Lotek4 Lotek   NTQB-2          NA  166.38 5.8985      2.5      4690
## 5  Lotek4 Lotek   NTQB-2          NA  166.38 6.0962      2.5      4690
## 6  Lotek4 Lotek   NTQB-2          NA  166.38 6.0962      2.5      4690
##   markerNumber markerType depLat  depLon depAlt comments startCode endCode
## 1    257156244 metal band 44.559 -67.768     NA     &lt;NA&gt;        NA      NA
## 2    257156244 metal band 44.559 -67.768     NA     &lt;NA&gt;        NA      NA
## 3    257156244 metal band 44.559 -67.768     NA     &lt;NA&gt;        NA      NA
## 4    257156244 metal band 44.559 -67.768     NA     &lt;NA&gt;        NA      NA
## 5    257156230 metal band 44.559 -67.768     NA     &lt;NA&gt;        NA      NA
## 6    257156230 metal band 44.559 -67.768     NA     &lt;NA&gt;        NA      NA
##             fullID       recv        site isMobile projID antType
## 1  ?proj?-8#28:5.9       &lt;NA&gt;        &lt;NA&gt;       NA     NA    &lt;NA&gt;
## 2  ?proj?-8#28:5.9       &lt;NA&gt;        &lt;NA&gt;       NA     NA    &lt;NA&gt;
## 3  ?proj?-8#28:5.9       &lt;NA&gt;        &lt;NA&gt;       NA     NA    &lt;NA&gt;
## 4  ?proj?-8#28:5.9       &lt;NA&gt;        &lt;NA&gt;       NA     NA    &lt;NA&gt;
## 5 ?proj?-8#416:6.1 Lotek-6303 manual 6303        0     10    &lt;NA&gt;
## 6 ?proj?-8#416:6.1 Lotek-6303 manual 6303        0     10    &lt;NA&gt;
##   antBearing antHeight cableLen cableType mountDistance mountBearing
## 1         NA        NA       NA      &lt;NA&gt;            NA           NA
## 2         NA        NA       NA      &lt;NA&gt;            NA           NA
## 3         NA        NA       NA      &lt;NA&gt;            NA           NA
## 4         NA        NA       NA      &lt;NA&gt;            NA           NA
## 5         NA        NA       NA      &lt;NA&gt;            NA           NA
## 6         NA        NA       NA      &lt;NA&gt;            NA           NA
##   polarization1 polarization2                   spEN                spFR
## 1            NA            NA Semipalmated Sandpiper Bécasseau semipalmé
## 2            NA            NA Semipalmated Sandpiper Bécasseau semipalmé
## 3            NA            NA Semipalmated Sandpiper Bécasseau semipalmé
## 4            NA            NA Semipalmated Sandpiper Bécasseau semipalmé
## 5            NA            NA Semipalmated Sandpiper Bécasseau semipalmé
## 6            NA            NA Semipalmated Sandpiper Bécasseau semipalmé
##              spSci spGroup  tagProj  proj lat lon alt
## 1 Calidris pusilla   BIRDS HolbSESA  &lt;NA&gt;   0   0   0
## 2 Calidris pusilla   BIRDS HolbSESA  &lt;NA&gt;   0   0   0
## 3 Calidris pusilla   BIRDS HolbSESA  &lt;NA&gt;   0   0   0
## 4 Calidris pusilla   BIRDS HolbSESA  &lt;NA&gt;   0   0   0
## 5 Calidris pusilla   BIRDS HolbSESA Taylr   0   0   0
## 6 Calidris pusilla   BIRDS HolbSESA Taylr   0   0   0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(df.flat)   ## summary of each column in your df</code></pre></div>
<pre><code>##      hitID              runID            batchID           ts           
##  Min.   :13188267   Min.   :1145488   Min.   :  58   Min.   :1.377e+09  
##  1st Qu.:21265452   1st Qu.:1764304   1st Qu.: 281   1st Qu.:1.408e+09  
##  Median :22861194   Median :1789815   Median :5769   Median :1.409e+09  
##  Mean   :22084378   Mean   :1779209   Mean   :3028   Mean   :1.405e+09  
##  3rd Qu.:22899098   3rd Qu.:1792824   3rd Qu.:5775   3rd Qu.:1.409e+09  
##  Max.   :28868881   Max.   :3459713   Max.   :6239   Max.   :1.415e+09  
##                                                                         
##       sig             sigsd             noise             freq       
##  Min.   :-80.63   Min.   :  0.000   Min.   :-96.00   Min.   :0.6666  
##  1st Qu.:-71.68   1st Qu.:  8.096   1st Qu.:-84.83   1st Qu.:4.1117  
##  Median :-66.37   Median : 14.065   Median :-82.72   Median :4.4635  
##  Mean   :-65.27   Mean   : 18.913   Mean   :-80.73   Mean   :4.5155  
##  3rd Qu.:-60.13   3rd Qu.: 24.405   3rd Qu.:-77.91   3rd Qu.:4.8747  
##  Max.   :255.00   Max.   :133.169   Max.   :-40.27   Max.   :9.6847  
##                                                                      
##      freqsd             slop             burstSlop               done  
##  Min.   :0.00000   Min.   :0.0000000   Min.   :-0.0598000   Min.   :0  
##  1st Qu.:0.00860   1st Qu.:0.0002000   1st Qu.:-0.0001000   1st Qu.:1  
##  Median :0.01450   Median :0.0003000   Median : 0.0000000   Median :1  
##  Mean   :0.02328   Mean   :0.0004799   Mean   : 0.0001368   Mean   :1  
##  3rd Qu.:0.02670   3rd Qu.:0.0005000   3rd Qu.: 0.0002000   3rd Qu.:1  
##  Max.   :0.27600   Max.   :0.0056000   Max.   : 0.0656000   Max.   :1  
##                                                                        
##    motusTagID         ant            runLen          bootnum      
##  Min.   :10465   Min.   :0.000   Min.   :  2.00   Min.   :  1.00  
##  1st Qu.:10472   1st Qu.:2.000   1st Qu.: 13.00   1st Qu.: 26.00  
##  Median :10487   Median :2.000   Median : 26.00   Median : 26.00  
##  Mean   :11455   Mean   :2.411   Mean   : 48.95   Mean   : 25.19  
##  3rd Qu.:10502   3rd Qu.:3.000   3rd Qu.: 53.00   3rd Qu.: 26.00  
##  Max.   :17399   Max.   :4.000   Max.   :500.00   Max.   :353.00  
##                                                                   
##    tagProjID      id              tagType            codeSet         
##  Min.   :8   Length:149939      Length:149939      Length:149939     
##  1st Qu.:8   Class :character   Class :character   Class :character  
##  Median :8   Mode  :character   Mode  :character   Mode  :character  
##  Mean   :8                                                           
##  3rd Qu.:8                                                           
##  Max.   :8                                                           
##                                                                      
##      mfg              tagModel          tagLifespan        nomFreq     
##  Length:149939      Length:149939      Min.   : NA      Min.   :166.3  
##  Class :character   Class :character   1st Qu.: NA      1st Qu.:166.4  
##  Mode  :character   Mode  :character   Median : NA      Median :166.4  
##                                        Mean   :NaN      Mean   :166.4  
##                                        3rd Qu.: NA      3rd Qu.:166.4  
##                                        Max.   : NA      Max.   :166.4  
##                                        NA&#39;s   :149939                  
##      tagBI          pulseLen     speciesID    markerNumber      
##  Min.   :5.898   Min.   :2.5   Min.   :4180   Length:149939     
##  1st Qu.:5.898   1st Qu.:2.5   1st Qu.:4690   Class :character  
##  Median :6.096   Median :2.5   Median :4690   Mode  :character  
##  Mean   :6.215   Mean   :2.5   Mean   :4690                     
##  3rd Qu.:6.697   3rd Qu.:2.5   3rd Qu.:4690                     
##  Max.   :7.097   Max.   :2.5   Max.   :4750                     
##                                                                 
##   markerType            depLat          depLon           depAlt      
##  Length:149939      Min.   :44.52   Min.   :-67.84   Min.   : NA     
##  Class :character   1st Qu.:44.52   1st Qu.:-67.77   1st Qu.: NA     
##  Mode  :character   Median :44.56   Median :-67.77   Median : NA     
##                     Mean   :44.54   Mean   :-67.77   Mean   :NaN     
##                     3rd Qu.:44.56   3rd Qu.:-67.76   3rd Qu.: NA     
##                     Max.   :44.58   Max.   :-67.76   Max.   : NA     
##                                                      NA&#39;s   :149939  
##    comments           startCode         endCode          fullID         
##  Length:149939      Min.   : NA      Min.   : NA      Length:149939     
##  Class :character   1st Qu.: NA      1st Qu.: NA      Class :character  
##  Mode  :character   Median : NA      Median : NA      Mode  :character  
##                     Mean   :NaN      Mean   :NaN                        
##                     3rd Qu.: NA      3rd Qu.: NA                        
##                     Max.   : NA      Max.   : NA                        
##                     NA&#39;s   :149939   NA&#39;s   :149939                     
##      recv               site              isMobile      projID  
##  Length:149939      Length:149939      Min.   :0    Min.   : 8  
##  Class :character   Class :character   1st Qu.:0    1st Qu.: 8  
##  Mode  :character   Mode  :character   Median :0    Median : 8  
##                                        Mean   :0    Mean   : 8  
##                                        3rd Qu.:0    3rd Qu.: 8  
##                                        Max.   :0    Max.   :10  
##                                        NA&#39;s   :73   NA&#39;s   :73  
##    antType            antBearing      antHeight         cableLen     
##  Length:149939      Min.   :168.0   Min.   : NA      Min.   : NA     
##  Class :character   1st Qu.:168.0   1st Qu.: NA      1st Qu.: NA     
##  Mode  :character   Median :212.0   Median : NA      Median : NA     
##                     Mean   :200.1   Mean   :NaN      Mean   :NaN     
##                     3rd Qu.:212.0   3rd Qu.: NA      3rd Qu.: NA     
##                     Max.   :260.0   Max.   : NA      Max.   : NA     
##                     NA&#39;s   :87      NA&#39;s   :149939   NA&#39;s   :149939  
##   cableType         mountDistance     mountBearing    polarization1   
##  Length:149939      Min.   : NA      Min.   : NA      Min.   : NA     
##  Class :character   1st Qu.: NA      1st Qu.: NA      1st Qu.: NA     
##  Mode  :character   Median : NA      Median : NA      Median : NA     
##                     Mean   :NaN      Mean   :NaN      Mean   :NaN     
##                     3rd Qu.: NA      3rd Qu.: NA      3rd Qu.: NA     
##                     Max.   : NA      Max.   : NA      Max.   : NA     
##                     NA&#39;s   :149939   NA&#39;s   :149939   NA&#39;s   :149939  
##  polarization2        spEN               spFR              spSci          
##  Min.   : NA      Length:149939      Length:149939      Length:149939     
##  1st Qu.: NA      Class :character   Class :character   Class :character  
##  Median : NA      Mode  :character   Mode  :character   Mode  :character  
##  Mean   :NaN                                                              
##  3rd Qu.: NA                                                              
##  Max.   : NA                                                              
##  NA&#39;s   :149939                                                           
##    spGroup            tagProj              proj                lat       
##  Length:149939      Length:149939      Length:149939      Min.   : 0.00  
##  Class :character   Class :character   Class :character   1st Qu.:44.56  
##  Mode  :character   Mode  :character   Mode  :character   Median :44.56  
##                                                           Mean   :44.56  
##                                                           3rd Qu.:44.56  
##                                                           Max.   :44.65  
##                                                           NA&#39;s   :21158  
##       lon              alt       
##  Min.   :-67.81   Min.   :-0.10  
##  1st Qu.:-67.81   1st Qu.:12.60  
##  Median :-67.81   Median :14.30  
##  Mean   :-67.80   Mean   :14.77  
##  3rd Qu.:-67.81   3rd Qu.:16.20  
##  Max.   :  0.00   Max.   :37.20  
##  NA&#39;s   :21158    NA&#39;s   :21158</code></pre>
<p>If you want to load only part of your entire data frame (eg. certain fields, only certain tags, all tags from a specified project, species, etc.), you can use dplyr funtions to filter the data before collecting into a flat dataframe. Some examples are below:</p>
<ol style="list-style-type: decimal">
<li>To select certain fields:</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.flat.subset &lt;-<span class="st"> </span><span class="kw">select</span>(df, recv, ant, motusTagID) <span class="op">%&gt;%</span><span class="st"> </span>distinct <span class="op">%&gt;%</span><span class="st"> </span>collect <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame      ## to grab a subset of fields, in this case a unique list of motus tag IDs at each receiver and antenna.</code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>To select certain tag IDs:</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.flat.subset &lt;-<span class="st"> </span><span class="kw">filter</span>(df, motusTagID <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">9939</span>, <span class="dv">25643</span>)) <span class="op">%&gt;%</span><span class="st"> </span>collect <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame    ## filter to only include detections of motus tag IDs 9939 and 25643</code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>To select a specified species:</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.flat.subset &lt;-<span class="st"> </span><span class="kw">filter</span>(df, speciesID <span class="op">==</span><span class="st"> </span><span class="dv">15580</span>) <span class="op">%&gt;%</span><span class="st"> </span>collect <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame    ## filter to only include detections of Swainson&#39;s Thrush by species ID
df.flat.subset &lt;-<span class="st"> </span><span class="kw">filter</span>(df, spEN <span class="op">==</span><span class="st"> &quot;Swainson&#39;s Thrush&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>collect <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame    ## filter to only include detections of Swainson&#39;s Thrush by English name</code></pre></div>
<p>You can also summarize your data before converting to a flat file. For example, to find the first hourly detection of each tag in each hour by receiver and antenna, you could do this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hourly &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span> (<span class="dt">hour =</span> <span class="dv">3600</span> <span class="op">*</span><span class="st"> </span><span class="kw">round</span>(ts <span class="op">/</span><span class="st"> </span><span class="dv">3600</span>, <span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">distinct</span> (recv, ant, motusTagID, hour)

## and collect these into a data.frame

hh &lt;-<span class="st"> </span>hourly <span class="op">%&gt;%</span><span class="st"> </span>collect <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</code></pre></div>
</div>
<div id="export-your-flat-dataframe-to-a-.csv-file" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Export your “flat” dataframe to a .csv file</h3>
<p>The below example is how you would save the flat file called “df.flat” within R, as a .csv file called “JB_raw.csv” on your computer in the ‘data’ folder of your working directory. In this case, JB stands for James Bay, and we are simply converting the data without subsetting.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write.csv</span>(df.flat, <span class="st">&quot;./data/JB_raw.csv&quot;</span>)  ## &quot;df.flat&quot;&quot; is the name of the flat file within R that you want to convert to a .csv
## &quot;./data/&quot; is the the location where you would like your .csv stored
## &quot;JB_raw.csv&quot;, is the name of the .csv file you are creating, this can be anything you like but must end with .csv.</code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="loading-the-motus-r-package.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-checking-metadata.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["MotusRBook.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
