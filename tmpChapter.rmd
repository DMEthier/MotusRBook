Not sure where this should go yet. Not really a metadata check.

### Number of deployed tags with detections.

There are several reasons why deployed tags might not have detections data. These include:

1) the tag was not properly activated on deployment. To avoid this, always check that a tag is active using a hand-held receiver before attaching the tag to your study animal and releasing it. 

2) an animal with a properly activated tag might not pass within range of a receiving station. Study designs that incorporate strategic placement of receivers to meet project goals can improve your odds of getting detections of your tags.

3) missing or incorrect tag deployment metadata can result in the tagFinder not 'looking' for your tag at the time the tag was deployed, or at all. Incorrect metadata can also be a concern if there are duplicate tags in the system; the tagFinder will only assign detections as ambiguous during the lifetime of your tag, which is estimated based on metadata. If your metadata are incorrect, there is the potential for detections of your tags that occur *outside* the estimated lifespan to be assigned unambiguously to a duplicate tag from another project, and not assigned to your tag at all. 

The following code creates a database 'df.nDetect' which calculates the number of detections of each deployed tag in your detections database. 

```{r tagsWithDetections}

# load detections data

df.alltagswithambigs <- readRDS("./data/df.alltagswithambigs.rds")

df.nDetect <- full_join(select(df.alltagswithambigs, motusTagID, tagDeployID) %>% 
                          group_by(motusTagID, tagDeployID) %>%
                          summarize(nDetect = n()), 
                        select(df.tagDeps, tagID, deployID) %>% 
                          distinct() %>% 
                          as.data.frame(), 
                        by = c("motusTagID" = "tagID", "tagDeployID" = "deployID")) %>%
                        as.data.frame()
```

To list all tagIDs with at least one detection, you can run the following code; recall that we are using a small sample of the James Bay Shorebird Monitoring Project data, so only those tags included in the sample dataset will have detections here:

```{r tagsWithDetections}

filter(df.nDetect, nDetect > 0) %>% 
  select(motusTagID) %>% 
  as.list()

```

And generate a list of tags without detections; there are 671 because we are using only a subset of the full dataset (not evaluated here):

```{r tagsWithoutDetections, eval = FALSE}

filter(df.nDetect, is.na(nDetect)) %>% select(motusTagID) %>% as.list()

```

If you are missing detections for deployed tags that you believe should have been detected, the first step is to check that your metadata are complete and accurate, which we do next.
